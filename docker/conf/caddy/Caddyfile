# Railway Caddy configuration - binds to all interfaces
:80 {
    # Resolve the root directory for the app
    root * /var/www/html/public

    # Health check endpoints - serve directly for speed
    respond /up "OK" 200
    respond /health "OK" 200
    respond /health.php "OK" 200

    # Enable logging for debugging
    log {
        output stdout
        format console
    }

    # Allow caddy to serve static files
    file_server

    # Enable PHP-FPM for Laravel routes
    php_fastcgi 127.0.0.1:9000 {
        # Trust Railway proxies
        trusted_proxies private_ranges
    }

    # CORS headers for API
    header {
        Access-Control-Allow-Origin *
        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
        Access-Control-Allow-Credentials true
    }
}
